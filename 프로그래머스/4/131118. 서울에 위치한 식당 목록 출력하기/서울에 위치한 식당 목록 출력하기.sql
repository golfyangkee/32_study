-- 서울에 위치한 식당 출력
# SELECT *
# FROM REST_INFO 
# WHERE ADDRESS LIKE '서울%';

-- 식당별 리뷰 평균 출력
# SELECT REST_ID, ROUND(AVG(REVIEW_SCORE), 2) AS SCORE
# FROM REST_REVIEW 
# GROUP BY REST_ID;

-- 정답
SELECT RI.REST_ID, RI.REST_NAME, RI.FOOD_TYPE, RI.FAVORITES, RI.ADDRESS, IFNULL(RS.SCORE, 0) AS SCORE
FROM REST_INFO RI 
    JOIN (SELECT REST_ID, ROUND(AVG(REVIEW_SCORE), 2) AS SCORE
            FROM REST_REVIEW 
            GROUP BY REST_ID) RS USING(REST_ID)
WHERE RI.ADDRESS LIKE '서울%'
ORDER BY RS.SCORE DESC, RI.FAVORITES DESC;